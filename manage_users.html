```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Manage Users - Alpha-Med Clinical Lab</title>
  <link rel="stylesheet" href="style.css" />
  <script defer src="storage.js"></script>
</head>
<body>
  <header>
    <h1>Manage Users - Alpha-Med Clinical Lab</h1>
  </header>

  <div class="container">
    <h2>Add/Edit User</h2>
    <form id="userForm">
      <input type="text" id="cnic" placeholder="CNIC (e.g. 34501-1234567-1)" required />
      <input type="text" id="name" placeholder="Full Name" required />
      <select id="role" required>
        <option value="">Select Role</option>
        <option value="Receptionist">Receptionist</option>
        <option value="Technician">Technician</option>
        <option value="Admin">Admin</option>
      </select>
      <input type="password" id="password" placeholder="Password" required />
      <input type="hidden" id="editIndex" />
      <button type="submit" id="submitButton">Add User</button>
    </form>
    <div class="error" id="error"></div>

    <h3>Search Users</h3>
    <input type="text" id="searchUser" placeholder="Search by CNIC or Name..." />

    <table id="userTable">
      <thead>
        <tr>
          <th>CNIC</th>
          <th>Name</th>
          <th>Role</th>
          <th>Password</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="userList"></tbody>
    </table>
  </div>

  <footer>&copy; 2025 Alpha-Med Clinical Lab</footer>

  <script>
    function loadUsers() {
      const users = window.getAllUsers();
      const tbody = document.getElementById("userList");
      const errorDiv = document.getElementById("error");
      tbody.innerHTML = "";

      if (!users.length) {
        errorDiv.textContent = "No users found";
        return;
      }

      errorDiv.textContent = "";
      users.forEach((user, index) => {
        const row = tbody.insertRow();
        row.innerHTML = `
          <td>${user.cnic}</td>
          <td>${user.name}</td>
          <td>${user.role}</td>
          <td>${"*".repeat(user.password.length)}</td>
          <td>
            <button class="btn-primary" onclick="editUser(${index})">Edit</button>
            <button class="btn-danger" onclick="window.deleteUser(${index}); loadUsers();">Delete</button>
          </td>
        `;
      });

      window.attachTableSearch("searchUser", "userTable");
    }

    function editUser(index) {
      const users = window.getAllUsers();
      const user = users[index];
      document.getElementById("cnic").value = user.cnic;
      document.getElementById("name").value = user.name;
      document.getElementById("role").value = user.role;
      document.getElementById("password").value = atob(user.password);
      document.getElementById("editIndex").value = index;
      document.getElementById("submitButton").textContent = "Update User";
    }

    document.getElementById("userForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const cnic = document.getElementById("cnic").value.trim();
      const name = document.getElementById("name").value.trim();
      const role = document.getElementById("role").value;
      const password = document.getElementById("password").value;
      const editIndex = document.getElementById("editIndex").value;
      const errorDiv = document.getElementById("error");

      const user = { cnic, name, role, password: btoa(password) };
      const saved = editIndex ? window.updateUser(parseInt(editIndex), user) : window.addUser(user);

      if (!saved) {
        errorDiv.textContent = editIndex ? "Error updating user" : "User with this CNIC already exists";
        return;
      }

      errorDiv.textContent = "";
      document.getElementById("userForm").reset();
      document.getElementById("submitButton").textContent = "Add User";
      document.getElementById("editIndex").value = "";
      loadUsers();
    });

    document.addEventListener("DOMContentLoaded", loadUsers);
  </script>
</body>
</html>
```

### Updates to `storage.js`
User management logic ko `storage.js` mein move kar raha hoon taaki code consistent rahe. Yeh previous `storage.js` (artifact ID: `65c5c4d9-0c2c-4606-8b14-e9739b1107d3`) ko extend karta hai, aur `addUser`, `updateUser`, `deleteUser`, aur `getAllUsers` functions add karta hai.

<xaiArtifact artifact_id="cc9c9d8a-edca-495a-9bc6-6fdc9b8b5fe3" artifact_version_id="840dfa64-ac9a-46ef-ad4f-73c3dbabc253" title="storage.js" contentType="application/javascript">
```javascript
function savePatient(patient) {
  try {
    let patients = JSON.parse(localStorage.getItem("patients") || "[]");
    if (patients.some(p => p.cnic === patient.cnic)) {
      if (!confirm("Patient with this CNIC is already registered. Do you want to add again?")) {
        return false;
      }
    }
    patients.push(patient);
    localStorage.setItem("patients", JSON.stringify(patients));
    return true;
  } catch (err) {
    console.error("Error saving patient:", err);
    return false;
  }
}

function getAllPatients() {
  try {
    return JSON.parse(localStorage.getItem("patients") || "[]");
  } catch (err) {
    console.error("Error reading patients:", err);
    return [];
  }
}

function saveTestResult(result) {
  try {
    let results = JSON.parse(localStorage.getItem("results") || "[]");
    results.push(result);
    localStorage.setItem("results", JSON.stringify(results));
    return true;
  } catch (err) {
    console.error("Error saving test result:", err);
    return false;
  }
}

function getAllResults() {
  try {
    return JSON.parse(localStorage.getItem("results") || "[]");
  } catch (err) {
    console.error("Error reading results:", err);
    return [];
  }
}

function addUser(user) {
  try {
    let users = JSON.parse(localStorage.getItem("users") || "[]");
    if (users.some(u => u.cnic === user.cnic)) {
      return false;
    }
    if (!/^\d{5}-\d{7}-\d{1}$/.test(user.cnic)) {
      return false;
    }
    users.push(user);
    localStorage.setItem("users", JSON.stringify(users));
    return true;
  } catch (err) {
    console.error("Error adding user:", err);
    return false;
  }
}

function updateUser(index, user) {
  try {
    let users = JSON.parse(localStorage.getItem("users") || "[]");
    if (index < 0 || index >= users.length) {
      return false;
    }
    if (!/^\d{5}-\d{7}-\d{1}$/.test(user.cnic)) {
      return false;
    }
    if (users.some((u, i) => i !== index && u.cnic === user.cnic)) {
      return false;
    }
    users[index] = user;
    localStorage.setItem("users", JSON.stringify(users));
    return true;
  } catch (err) {
    console.error("Error updating user:", err);
    return false;
  }
}

function deleteUser(index) {
  try {
    let users = JSON.parse(localStorage.getItem("users") || "[]");
    if (index < 0 || index >= users.length) {
      return false;
    }
    users.splice(index, 1);
    localStorage.setItem("users", JSON.stringify(users));
    return true;
  } catch (err) {
    console.error("Error deleting user:", err);
    return false;
  }
}

function getAllUsers() {
  try {
    return JSON.parse(localStorage.getItem("users") || "[]");
  } catch (err) {
    console.error("Error reading users:", err);
    return [];
  }
}

function clearAllPatients() {
  if (confirm("Are you sure you want to delete all patients?")) {
    localStorage.removeItem("patients");
    localStorage.removeItem("results");
    alert("All patients and results cleared!");
  }
}

function validateUser(username, password) {
  try {
    const users = JSON.parse(localStorage.getItem("users") || "[]");
    return users.some(user => user.cnic === username && user.password === btoa(password));
  } catch (err) {
    console.error("Error validating user:", err);
    return false;
  }
}

function attachTableSearch(inputId, tableId) {
  const input = document.getElementById(inputId);
  const table = document.getElementById(tableId);
  if (!input || !table) return;
  input.addEventListener("keyup", function () {
    const filter = input.value.toLowerCase();
    const rows = table.getElementsByTagName("tr");
    for (let i = 0; i < rows.length; i++) {
      if (rows[i].getElementsByTagName("th").length > 0) continue;
      const rowText = rows[i].textContent.toLowerCase();
      rows[i].style.display = rowText.includes(filter) ? "" : "none";
    }
  });
}
```

### Updates to `style.css`
Inline CSS ko `style.css` mein merge kar raha hoon taaki styling consistent rahe. Yeh previous `style.css` (artifact ID: `7d93e7b8-1978-4c3a-b15f-b95c9052ab06`) ko extend karta hai.

<xaiArtifact artifact_id="ea3110c4-2e45-4fa2-b461-e1075636e0c4" artifact_version_id="de0b3d2b-e38e-4315-89d9-4234d64ff016" title="style.css" contentType="text/css">
```css
body {
    font-family: 'Segoe UI', Arial, sans-serif;
    margin: 0;
    padding: 40px;
    background-color: #f4f6f9;
    color: #333;
}

header {
    background-color: #2c3e50;
    color: white;
    padding: 1rem;
    text-align: center;
}

h1, h2, h3, h4 {
    margin: 0;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.report-container {
    max-width: 1000px;
    background-color: #1d1f27;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 0 15px rgba(0,0,0,0.4);
    color: white;
}

.slip-container {
    max-width: 600px;
    background: white;
    border-radius: 12px;
    padding: 30px;
    box-shadow: 0 0 15px rgba(0,0,0,0.1);
}

.header {
    text-align: center;
    margin-bottom: 25px;
}

.header img {
    height: 70px;
}

.info-row {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    margin-bottom: 12px;
    font-size: 16px;
    word-break: break-word;
}

.info-row span:first-child {
    font-weight: 600;
}

.qr {
    text-align: center;
    margin-top: 30px;
}

.dashboard {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    padding: 30px;
}

.card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    cursor: pointer;
    transition: all 0.2s ease-in-out;
}

.card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.card h3 {
    margin-bottom: 10px;
    color: #34495e;
}

.card p {
    color: #888;
    font-size: 14px;
}

.patient-list, .result-form, .form-section, .table-section {
    margin-top: 30px;
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.search-box, .search-bar {
    text-align: center;
    margin-bottom: 20px;
}

#searchPatient, #searchMRN, #searchInput, #searchAdmin, #searchUser {
    width: 100%;
    max-width: 400px;
    margin-bottom: 20px;
    padding: 12px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
}

select, input, button, textarea {
    padding: 10px;
    margin: 10px 0;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

.result-form label, .form-section label {
    display: block;
    margin: 10px 0 5px;
}

textarea {
    width: 100%;
    resize: vertical;
}

button {
    background-color: #2980b9;
    color: white;
    border: none;
    cursor: pointer;
    padding: 8px 14px;
    border-radius: 6px;
}

button:hover {
    background-color: #1c5981;
}

.btn-primary {
    background-color: #007bff;
}

.btn-primary:hover {
    background-color: #0056b3;
}

.btn-danger {
    background-color: #dc3545;
}

.btn-danger:hover {
    background-color: #c82333;
}

.btn-success {
    background-color: #28a745;
}

.btn-success:hover {
    background-color: #218838;
}

table {
    width: 100%;
    border-collapse: collapse;
    background-color: white;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

th, td {
    padding: 12px;
    text-align: left;
    border: 1px solid #ccc;
}

th {
    background-color: #2a2d3a;
    color: white;
}

td {
    background-color: white;
}

tr:nth-child(even) {
    background-color: #f9f9f9;
}

tr:hover {
    background-color: #f5f5f5;
}

a {
    color: #00aaff;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

form {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 400px;
    margin: 0 auto;
}

.error {
    color: red;
    font-size: 14px;
}

.no-print {
    text-align: center;
    color: #777;
    font-size: 14px;
    margin-top: 20px;
}

.admin-actions {
    margin-bottom: 20px;
}

footer {
    margin-top: 40px;
    text-align: center;
    color: #999;
    font-size: 14px;
    padding-bottom: 20px;
}

@media print {
    body {
        background: none;
        padding: 0;
    }

    .container, .slip-container {
        box-shadow: none;
        border: 1px solid #ccc;
    }

    .no-print {
        display: none;
    }
}
```

