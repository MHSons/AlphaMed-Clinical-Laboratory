```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Export Data - Alpha-Med Clinical Lab</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>
  <script defer src="test-data.js"></script>
  <script defer src="storage.js"></script>
  <script defer src="script.js"></script>
</head>
<body onload="checkLogin('admin')">
  <header>
    <h1>Export Data - Alpha-Med Clinical Lab</h1>
  </header>

  <div class="container">
    <h2>Export Patient Data</h2>
    <div class="export-actions">
      <button class="btn-primary" onclick="exportToExcel()">Export to Excel</button>
      <button class="btn-primary" onclick="exportToPDF()">Export to PDF</button>
    </div>
    <div class="error" id="error"></div>

    <table id="exportTable">
      <thead>
        <tr>
          <th>MRN</th>
          <th>Name</th>
          <th>CNIC</th>
          <th>Phone</th>
          <th>Department</th>
          <th>Tests</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody id="patientList"></tbody>
    </table>
  </div>

  <footer>&copy; 2025 Alpha-Med Clinical Lab</footer>

  <script>
    function loadPatientData() {
      const patients = window.getAllPatients();
      const tbody = document.getElementById("patientList");
      const errorDiv = document.getElementById("error");
      tbody.innerHTML = "";

      if (!patients.length) {
        errorDiv.textContent = "No patient data available";
        return;
      }

      errorDiv.textContent = "";
      patients.forEach(item => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${item.mrn || '-'}</td>
          <td>${item.name || '-'}</td>
          <td>${item.cnic || '-'}</td>
          <td>${item.phone || '-'}</td>
          <td>${item.department || '-'}</td>
          <td>${item.tests
            .map(testId => {
              const test = Object.values(window.testData).flat().find(t => t.id === testId);
              return test ? test.name : testId;
            })
            .join(", ") || '-'}</td>
          <td>${item.date || '-'}</td>
        `;
        tbody.appendChild(row);
      });
    }

    function exportToExcel() {
      const table = document.getElementById("exportTable");
      const wb = XLSX.utils.table_to_book(table, { sheet: "Patient Data" });
      XLSX.writeFile(wb, "AlphaMed_Patient_Data.xlsx");
    }

    function exportToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text("Alpha-Med Clinical Lab", 14, 15);
      doc.text("Patient Data Export", 14, 25);

      const rows = [];
      const table = document.querySelectorAll("#exportTable tbody tr");
      table.forEach(tr => {
        const row = [];
        tr.querySelectorAll("td").forEach(td => row.push(td.innerText));
        rows.push(row);
      });

      doc.autoTable({
        head: [["MRN", "Name", "CNIC", "Phone", "Department", "Tests", "Date"]],
        body: rows,
        startY: 35,
        theme: 'striped'
      });

      doc.save("AlphaMed_Patient_Data.pdf");
    }

    document.addEventListener("DOMContentLoaded", loadPatientData);
  </script>
</body>
</html>
```
